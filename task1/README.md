# Задание 1: кроп документов

[Чекпоинт модели находится тут](https://drive.google.com/file/d/1bREftDNv3T9-PTt10z6lKmDDyFU0Z5s9/view?usp=sharing)

После запуска контейнера нужно ещё доставить несколько пакетов:

`apt-get update && apt-get install ffmpeg libsm6 libxext6  -y`

## Описание
В этом разделе находятся материалы первого домашнего задания: пакет с кодом для работы с данными, вычислением метрик и пример baseline решения.

Для установки пакета выполните из `course_intro_ocr/task1` команду `pip install -e .`

## Задача
Реализовать какой-либо алгоритм кропа с использованием нейросетей, обучить и протестировать его на публичном датасете [MIDV-500](https://github.com/fcakyon/midv500).

Можно либо скачать полноразмерную версию датасета по официальной инструкции пакета (\~70Gb), либо [скачать](https://disk.yandex.ru/d/8ZxmzGCbgfe5OQ) сжатую версию датасета(`max(w,h)=800pix`, \~8Gb).

## Метрика
Для каждого примера датасета **из test сплита** вам необходимо предсказать четырехугольник документа (смотрите пример baseline).

Для предсказанного четырехгольника и истинного четырехугольника **вычисляется IntersectionOverUnion в пределах кадра**, и если это значение выше 95%, то кроп считается верным, иначе - ошибочным.

Для всего test сплита датасета вычисляется средняя точность предсказаний. Примерный псевдокод:
```python
AccIouAt95 = sum(
    int(iou(pred_quads[i], gt_quads[i]) > 0.95)
    for i in range(N)
) / N
```
## Требования
Вам необходимо сделать форк этого репозитория и в своем форке:
1. активировать github-actions (зайти в Actions и нажать зеленую кнопку)
1. заменить файл `task1/pred_quads.json` на файл с вашими предсказаниями в таком же формате (можно воспользоваться функцией `course_ocr_t1.metrics.dump_results_dict`)
1. добавить все необходимые для воспроизведения ваших результатов материалы ( скрипты, ноутбуки, файла )

GroundTruth четырехугольники сохранены в `task1/gt_quads.json`.

При пуше коммитов github-action будут автоматически вычислять и писать в stdout метрику на этапе "COMPUTE SCORE". Вы можете использовать функцию `course_ocr_t1.metrics.measure_crop_accuracy` для локального вычисления метрик.

## Оценка
За домашнюю работу можно получить 0-100%.
Чтобы решение было зачтено, весь код (модели, скрипты, ноутбуки) для воспроизведения ваших результатов должен быть в вашем репозитории в этом разделе.

Нельзя использовать код baseline для получения своих результатов. Нельзя смешивать baseline со своим решением.

Критерии оценки (Max 100b):

1. Acc=50% и выполнены требования: +50b
1. Acc=[50 - 70%]: +0.5b * Acc (Max +10b) 
1. Acc=[70 - 90%]: +1.0b * Acc (Max +20b) 
1. Acc=[90 -100%]: +2.0b * Acc (Max +20b) 


## Сроки
При выполнении дз в период \[22.02.2024-21.03.2024\] засчитывается полный набранный балл в соответствии с критериями. Границы включены в срок.

Далее за каждую неделю позже срока (с округлением вверх): -5b
Например:
- 22.03.2024: -5b
- 31.03.2024: -10b
